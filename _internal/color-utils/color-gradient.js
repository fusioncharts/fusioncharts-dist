import{parseUnsafeString,getValidValue,extend2,getComparatorFN}from'../lib/lib';import{HUNDREDSTRING}from'./strings-lib';import ComponentInterface from'../../core/component-interface';let UNDEF,sortColorFN=getComparatorFN(!0,'minvalue');class ColorGradient extends ComponentInterface{getType(){return'colorComponent'}getName(){return'colorGradient'}configure(a){var b,c,d,e,f,g,h,k,m,n,o=this,p=o.colorArr,q=o.getFromEnv('color-manager'),r=o.getFromEnv('number-formatter'),s=a.colorRange&&extend2({},a.colorRange).color,t=q.getColor('paletteColors');if(delete o.defaultAsigned,t instanceof Array||(t=q.getPlotColor(0)),s&&0<s.length){for(f=s.length-1,e=f;0<=e;e-=1)c=s[e],c&&(c.minvalue=r.getCleanValue(c.minvalue),c.maxvalue=r.getCleanValue(c.maxvalue),null===c.minvalue&&(null===c.maxvalue?e!==f&&s.splice(e,1):c.minvalue=c.maxvalue),c.label!==UNDEF&&(c.label=parseUnsafeString(c.label)),c.name!==UNDEF&&(c.name=parseUnsafeString(c.name)),null!==c.maxvalue&&c.minvalue>c.maxvalue&&(g=c.minvalue,c.minvalue=c.maxvalue,c.maxvalue=g));for(s.sort(sortColorFN),s[0].code||(s[0].code=t[0]),getValidValue(s[0].alpha)===UNDEF&&(s[0].alpha=HUNDREDSTRING),(e=0,f=s.length-1);e<f;e+=1)if(n=e+1,c=s[e],d=s[n],d.code||(d.code=t[n]),getValidValue(d.alpha)===UNDEF&&(d.alpha=HUNDREDSTRING),null===c.maxvalue&&(c.maxvalue=d.minvalue),c.maxvalue>d.minvalue){if(c.maxvalue>d.maxvalue){for(h=extend2(c),h.maxvalue=c.maxvalue,m=h.minvalue=d.maxvalue,k=e+2;k<f&&s[k].minvalue<m;)k+=1;s.splice(k,0,h),f+=1}c.maxvalue=d.minvalue}c=s[e],null===c.maxvalue&&(c.maxvalue=c.minvalue)}s&&s.length||(!b&&(b={code:'CCCCCC',alpha:'100',bordercolor:'000000',borderalpha:'100'}),s=[b],o.defaultAsigned=!0),o.colorArr=s||p}getColorObj(a){for(var b,c,d=this.colorArr,e=0,f=d.length,g={};e<f;e+=1){if(g.index=e,b=d[e],c=d[e+1],a<b.minvalue)return g.nextObj=b,g;if(a>=b.minvalue&&a<=b.maxvalue)return g.colorObj=b,c&&a==c.minvalue&&(g.nextObj=c,g.isOnMeetPoint=!0),g;g.prevObj=b}return g.index=e-1,g}getColorRangeArr(a,b){var c,d,e,f,g,h,j,k,m=this.colorArr,n=[];if(!this.defaultAsigned&&(a>b&&(c=a,a=b,b=c),a<b&&(f=this.getColorObj(a),h=this.getColorObj(b),f&&h))){for(g=a,d=f.index,e=h.index;d<=e;d+=1)j=extend2({},m[d]),j.minvalue!==g&&(j.minvalue=g),n.push(j),k=j,g=j.maxvalue;k.maxvalue=b}return n}}export default ColorGradient;